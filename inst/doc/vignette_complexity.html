<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="M.A.J. Zondervan-Zwijnenburg, A. R. Johnson, R. Van de Schoot" />


<title>complexity</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">complexity</h1>
<h4 class="author">M.A.J. Zondervan-Zwijnenburg, A. R. Johnson, R. Van de Schoot</h4>



<p>Over a decade of research on the topic of informative hypotheses has resulted in a bunch of methodological, tutorial, and applied papers, books (e.g., Hoijtink, 2012), and several software packages (see <a href="https://informative-hypotheses.sites.uu.nl/">informative-hypotheses.sites.uu.nl</a>). Informative hypotheses with simple order constraints, such as <span class="math inline">\(H_i\text{: }\mu_1 &gt; \mu_2 &gt; \mu_3\)</span>, <span class="math inline">\(H_i: \mu_1 &gt; (\mu_2, \mu_3)\)</span> have proven their use: not only do these hypotheses represent researchers’ expectations better, they also have more statistical power than classical hypotheses (Vanbrabant et al., 2015). The Bayes Factor (BF) is a Bayesian measure of support used for model selection (Kass and raftery, 1995). The BF can also be used for the evaluation of informative hypotheses. Using the BF, the support in the data for an informative hypothesis (<span class="math inline">\(H_i\)</span>) versus the unconstrained alternative (<span class="math inline">\(H_u\)</span>) can be calculated. As was shown by Klugkist et al. (2005):</p>
<p><span class="math display">\[
BF_{{H_i,H_u}} = \frac{f_i}{c_i},
\]</span></p>
<p>where <span class="math inline">\(f_i\)</span> denotes fit for the hypothesis <span class="math inline">\(H_i\)</span>, and <span class="math inline">\(c_i\)</span> denotes complexity for the hypothesis <span class="math inline">\(H_i\)</span>. <span class="math inline">\(f_i\)</span> is a measure of agreement between the data and <span class="math inline">\(H_i\)</span>, it is the posterior probability of the hypothesis given the data. <span class="math inline">\(f_i\)</span> can only be calculated after the data is observed. <span class="math inline">\(c_i\)</span> refers to the proportion of the parameter space in agreement with the hypothesis by chance: the a priori probability of the hypothesis. Complexity can be calculated before conducting the analysis.</p>
<p>In case of multivariate analyses, BIEMS (Mulder et al., 2012) can be used to estimate the BF. For structural equation models, BF-SEM has been developed (Gu et al., submitted). The computation of the BF for structural equation models calculated in Mplus (Muthén and Muthén, 1998-2012) is described by Van de Schoot et al. (2012). As these authors show, fit can be calculated by means of <strong>MplusAutomation</strong> (Hallquist, 2013), and complexity can be calculated manually. With few parameters and few constraints, this manual computation of <span class="math inline">\(c_i\)</span> is easy. When the number of parameters and constraints increases, however, it is preferable to automate the process. Therefore, we published the CRAN package <strong>complexity</strong> (Zondervan-Zwijnenburg, 2017). The code for the complexity function is provided in Appendix A. We will consider two examples in which the goal is to obtain the complexity for the hypothesis of interest to demonstrate the <strong>complexity</strong> package.</p>
<div id="example-1" class="section level2">
<h2>Example 1</h2>
<p>The first example includes four regression coefficients: <span class="math inline">\(\beta_1, \beta_2, \beta_3\)</span>, and <span class="math inline">\(\beta_4\)</span>. The expectation is that <span class="math inline">\(\beta_1\)</span> is smaller than <span class="math inline">\(\beta_2\)</span> and that <span class="math inline">\(\beta_3\)</span> is smaller than <span class="math inline">\(\beta_4\)</span>, which can be expressed as, <span class="math inline">\(H_i: (\beta_1 &lt; \beta_2\)</span>) &amp; (<span class="math inline">\(\beta_3 &lt; \beta_4)\)</span>.</p>
<div id="manual-computation-of-c_i" class="section level3">
<h3>Manual computation of <span class="math inline">\(c_i\)</span></h3>
<ol style="list-style-type: decimal">
<li><p>Obtain all possible ways in which the parameters can be ordered; for the first example there are <span class="math inline">\(4! = 4\times 3 \times 2 \times 1= 24\)</span> different ways of ordering the parameters.</p></li>
<li><p>Count the number of possible orderings that are in line with each of the informative hypotheses: in this example it is six.</p></li>
<li><p>Divide the value obtained in step 2 by the value obtained in step 1. In our example: <span class="math inline">\(c_i = 6/24 = 0.25\)</span>.</p></li>
</ol>
</div>
<div id="automated-computation-of-c_i" class="section level3">
<h3>Automated computation of <span class="math inline">\(c_i\)</span></h3>
<ol style="list-style-type: decimal">
<li>Use the complexity function from the <strong>complexity</strong> package as follows: <code>complexity(4,1,2,3,4)</code>. Here, the first <code>4</code> stands for the four parameters involved in the analysis. Every following set of two numbers, represents a constraint in which the first parameter is constrained to be lower than the second parameter. Hence, <code>1,2</code> refers to (<span class="math inline">\(\beta_1 &lt; \beta_2\)</span>) and <code>3,4</code> refers to (<span class="math inline">\(\beta_3 &lt; \beta_4\)</span>). If the hypothesis would have been (<span class="math inline">\(\beta_1 &lt; \beta_2\)</span>) &amp; (<span class="math inline">\(\beta_2 &gt; \beta_4\)</span>), the specification would be <code>complexity(4,1,2,4,2)</code>. Parameter 3 is then unrestricted. For <span class="math inline">\(\beta_1&lt;\beta_2&lt;\beta_3&lt;\beta_4\)</span> the correct specification is: <code>complexity(4,1,2,2,3,3,4)</code>. <code>complexity(4,1,2,3,4)</code> generates the following output:</li>
</ol>
<pre><code>## $`true permutations`
##      [,1] [,2] [,3] [,4]
## [1,]    1    2    3    4
## [2,]    1    4    2    3
## [3,]    1    3    2    4
## [4,]    3    4    1    2
## [5,]    2    3    1    4
## [6,]    2    4    1    3
## 
## $`total number of permutations`
## [1] 24
## 
## $`number true`
## [1] 6
## 
## $`complexity (proportion)`
## [1] 0.25</code></pre>
<p>The output shows:</p>
<ol style="list-style-type: decimal">
<li><p>the list of permutations in accordance with the request, where the column represents parameter and the numbers represent it’s position.</p></li>
<li><p>the total number of permutations.</p></li>
<li><p>the number of permutations in agreement with the hypothesis.</p></li>
<li><p>the percentage of permutations in agreement with the hypothesis (<span class="math inline">\(= c_i\)</span>).</p></li>
</ol>
</div>
</div>
<div id="example-2" class="section level2">
<h2>Example 2</h2>
<p>The second example comes from Johnson et al. (2015) and extends on the first example with two extra parameters that we hypothesize to be ordered as follows: <span class="math inline">\((\beta_1 &lt; \beta_2)\)</span> &amp; <span class="math inline">\((\beta_2, \beta_3 &gt; \beta_4)\)</span> &amp; <span class="math inline">\((\beta_4, \beta_5 &lt; \beta_6)\)</span>. Step two of the manual method will show that there are 720 ways in which these parameters can be ordered. Writing down all possibilities and counting the number of possibilities in agreement with the hypothesis is time consuming and prone to errors. Hence, we switch to the automated procedure. To determine the correct input, we need to specify all the separate constraints in terms of parameters smaller than other parameters. In this case: <span class="math inline">\((\beta_1 &lt; \beta_2)\)</span> &amp; <span class="math inline">\((\beta_4 &lt; \beta_2)\)</span> &amp; <span class="math inline">\((\beta_4 &lt; \beta_3)\)</span> &amp; <span class="math inline">\((\beta_4 &lt; \beta_6)\)</span> &amp; <span class="math inline">\((\beta_5 &lt; \beta_6)\)</span>. The number of parameters involved is six. Hence, the required input is: <code>complexity(6, 1,2,4,2,4,3,4,6,5,6)</code>. Almost immediately, the <strong>complexity</strong> package generates the following output:</p>
<pre><code>## $`true permutations`
##       [,1] [,2] [,3] [,4] [,5] [,6]
##  [1,]    1    6    5    2    3    4
##  [2,]    1    5    6    2    3    4
##  [3,]    1    4    6    2    3    5
##  [4,]    1    6    4    2    3    5
##  [5,]    1    4    5    2    3    6
##  [6,]    1    5    4    2    3    6
##  [7,]    5    6    4    1    2    3
##  [8,]    4    5    6    1    2    3
##  [9,]    4    6    5    1    2    3
## [10,]    1    5    4    3    2    6
## [11,]    1    4    5    3    2    6
## [12,]    1    6    4    3    2    5
## [13,]    1    4    6    3    2    5
## [14,]    1    4    3    2    5    6
## [15,]    1    3    4    2    5    6
## [16,]    1    5    3    2    4    6
## [17,]    1    5    6    3    2    4
## [18,]    1    6    5    3    2    4
## [19,]    1    3    5    2    4    6
## [20,]    1    6    3    2    4    5
## [21,]    1    3    6    2    4    5
## [22,]    3    6    5    1    2    4
## [23,]    3    5    6    1    2    4
## [24,]    5    6    3    1    2    4
## [25,]    3    4    6    1    2    5
## [26,]    3    6    4    1    2    5
## [27,]    3    4    5    1    2    6
## [28,]    3    5    4    1    2    6
## [29,]    4    5    3    1    2    6
## [30,]    4    6    3    1    2    5
## [31,]    4    6    3    2    1    5
## [32,]    4    5    3    2    1    6
## [33,]    3    5    4    2    1    6
## [34,]    3    4    5    2    1    6
## [35,]    3    6    4    2    1    5
## [36,]    3    4    6    2    1    5
## [37,]    3    4    2    1    5    6
## [38,]    5    6    3    2    1    4
## [39,]    3    5    2    1    4    6
## [40,]    3    5    6    2    1    4
## [41,]    3    6    5    2    1    4
## [42,]    3    6    2    1    4    5
## [43,]    2    3    6    1    4    5
## [44,]    2    6    3    1    4    5
## [45,]    2    3    5    1    4    6
## [46,]    2    6    5    3    1    4
## [47,]    2    5    6    3    1    4
## [48,]    2    5    3    1    4    6
## [49,]    2    3    4    1    5    6
## [50,]    2    4    3    1    5    6
## [51,]    2    4    6    3    1    5
## [52,]    2    6    4    3    1    5
## [53,]    2    4    5    3    1    6
## [54,]    2    5    4    3    1    6
## [55,]    4    6    2    1    3    5
## [56,]    4    6    5    2    1    3
## [57,]    4    5    6    2    1    3
## [58,]    4    5    2    1    3    6
## [59,]    5    6    4    2    1    3
## [60,]    2    5    4    1    3    6
## [61,]    2    4    5    1    3    6
## [62,]    2    6    4    1    3    5
## [63,]    2    4    6    1    3    5
## [64,]    5    6    2    1    3    4
## [65,]    2    5    6    1    3    4
## [66,]    2    6    5    1    3    4
## 
## $`total number of permutations`
## [1] 720
## 
## $`number true`
## [1] 66
## 
## $`complexity (proportion)`
## [1] 0.09166667</code></pre>
<p>The output shows that 66 out of 720 possibilities are in agreement with our hypothesis, which results in a complexity of .09. In addition, the output provides all permutations in agreement with the hypothesis for visual inspection of the results. The <strong>complexity</strong> package also includes a function that launches a <strong>Shiny</strong> (Chang et al., 2016) application with <code>runShiny()</code>. The output is the same as the output obtained with the <code>complexity</code> function.</p>
<p>Although it is possible to calculate the proportion of the parameter space in line with the hypothesis by chance (i.e., <span class="math inline">\(c_i\)</span>) manually, the second example showed that especially when the number of parameters involved becomes larger or when the constraints are more complex, it is easier and more reliable to use the complexity function in R to obtain the complexity for the Bayes Factor.</p>
<p>To compute the Bayes Factor for Example 2, the remaining element to compute is <span class="math inline">\(f_i\)</span>. To obtain <span class="math inline">\(f_i\)</span> we need to calculate the proportion of iterations in the Gibbs sampler that is in agreement with <span class="math inline">\((\beta_1 &lt; \beta_2)\)</span> &amp; <span class="math inline">\((\beta_2, \beta_3 &gt; \beta_4)\)</span> &amp; <span class="math inline">\((\beta_4, \beta_5 &lt; \beta_6)\)</span>. Using <strong>MplusAutomation</strong> we find that for  <span class="math inline">\(f_i\)</span> is .353.</p>
<p><span class="math display">\[
BF_{{H_i,H_u}} = \frac{.353}{.092} = 3.837.
\]</span></p>
<p>Thus, taking the model complexity into account, <span class="math inline">\(H_i\text{: }(\beta_1 &lt; \beta_2)\)</span> &amp; <span class="math inline">\((\beta_2, \beta_3 &gt; \beta_4)\)</span> &amp; <span class="math inline">\((\beta_4, \beta_5 &lt; \beta_6)\)</span> fits better than <span class="math inline">\(H_u\text{: }\beta_1, \beta_2, \beta_3, \beta_4, \beta_5, \beta_6\)</span>: the informative hypothesis receives more than three times the support.</p>
<p>##Summary The complexity of an informative hypothesis is required to calculate <span class="math inline">\(BF_{{H_i,H_u}}\)</span>. The <strong>complexity</strong> package enables the user to calculate <span class="math inline">\(c_i\)</span> quickly, even for more complicated hypotheses.</p>
<p>##Funding MZ is supported by the Consortium Individual Development (CID), which is funded through the Gravitation program of the Dutch Ministry of Education, Culture, and Science and the Netherlands Organization for Scientific Research (NWO grant number 024.001.003). RS is supported by a VIDI grant from the Netherlands Organization for Scientific Research (NWO grant number 452.14.006).</p>
<p>##About the authors <strong>Mariëlle Zondervan-Zwijnenburg</strong><br />
Department of Methodology &amp; Statistics<br />
Utrecht University<br />
The Netherlands</p>
<p><strong>Alan R. Johnson </strong><br />
Nord University Business School<br />
Bodø, Norway<br />
and<br />
RATIO Research Institute<br />
Stockholm, Sweden</p>
<p><strong>Rens van de Schoot</strong><br />
Department of Methodology &amp; Statistics<br />
Utrecht University<br />
The Netherlands</p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<ul>
<li><p>W. Chang, J. Cheng, J. Allaire, Y. Xie, and J. McPherson. shiny: Web Application Framework for R, 2016. URL <a href="https://CRAN.R-project.org/package=shiny" class="uri">https://CRAN.R-project.org/package=shiny</a>. R package version 0.13.2.</p></li>
<li><p>X. Gu, H. Hoijtink, J. Mulder, and Y. Rosseel. BF-SEM: A Fortran program for Bayesian testing of order constrained hypotheses in structural equation models. submitted.</p></li>
<li><p>M. Hallquist and J. Wiley. Mplusautomation: Automating Mplus Model Estimation and Interpretation, 2016. URL <a href="https://CRAN.R-project.org/package=MplusAutomation" class="uri">https://CRAN.R-project.org/package=MplusAutomation</a>.</p></li>
<li><p>H. Hoijtink. Informative hypotheses: Theory and practice for behavioral and social scientists. CRC Press, 2012.</p></li>
<li><p>A. R. Johnson, R. van de Schoot, F. Delmar, and W. D. Crano. Social influence interpretation of interpersonal processes and team performance over time using Bayesian model selection. Journal of Management, 41(2):574–606, 2015. doi: 10.1177/0149206314539351.</p></li>
<li><p>R. E. Kass and A. E. Raftery. Bayes factors. Journal of the american statistical association, 90(430):773–795, 1995. doi: 10.1080/01621459.1995.10476572</p></li>
<li><p>I. Klugkist, O. Laudy, and H. Hoijtink. Inequality constrained analysis of variance: a bayesian approach. Psychological Methods, 10(4):477, 2005. doi: 10.1037/1082-989X.10.4.477</p></li>
<li><p>J. Mulder, H. Hoijtink, and C. de Leeuw. BIEMS: A fortran 90 program for calculating bayes factors for inequality and equality constrained models. Journal of Statistical Software, 46(2):1–39, 2012.</p></li>
<li><p>L. K. Muthén and B. O. Muthén. Mplus user’s guide. Muthén &amp; Muthén, Los Angeles, CA, 7 edition, 1998-2012.</p></li>
<li><p>R. Van de Schoot, H. Hoijtink, M. N. Hallquist, and P. A. Boelen. Bayesian evaluation of inequality-constrained hypotheses in SEM models using Mplus. Structural Equation Modeling: A Multidisci- plinary Journal, 19(4):593–609, 2012. doi: 10.1080/10705511.2012.713267.</p></li>
<li><p>L. Vanbrabant, R. Van de Schoot, and Y. Rosseel. Constrained statistical inference: sample-size tables for ANOVA and regression. Frontiers in Psychology, 5:1565, 2015. doi: 10.3389/fpsyg.2014.01565.</p></li>
<li><p>M. Zondervan-Zwijnenburg. complexity: Calculate the Proportion of Permutations in Line with an Informative Hypothesis, 2017. URL <a href="https://CRAN.R-project.org/package=complexity" class="uri">https://CRAN.R-project.org/package=complexity</a>. R package version 1.1.2.</p></li>
</ul>
</div>
<div id="appendix-a" class="section level2">
<h2>Appendix A</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>complexity <span class="ot">&lt;-</span> <span class="cf">function</span>(npar,...){</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span>(combinat)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>npar)                       <span class="co">#the parameters to permute</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  perm <span class="ot">&lt;-</span> <span class="fu">permn</span>(values)                     <span class="co">#all permutations in a list</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  length <span class="ot">&lt;-</span> <span class="fu">length</span>(perm)                    <span class="co">#number of permutations</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  perm.matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">unlist</span>(perm),length, <span class="at">byrow=</span><span class="cn">TRUE</span>) </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>                                            <span class="co">#permutations in rows of matrix</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  dim <span class="ot">&lt;-</span> <span class="fu">dim</span>(perm.matrix)                   <span class="co">#length and width of permutation matrix</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">unlist</span>(<span class="fu">list</span>(...)),<span class="at">ncol=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>)  </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>                                            <span class="co">#one set of restriction values in each row</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  dimz <span class="ot">&lt;-</span> <span class="fu">dim</span>(z)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> dimz[<span class="dv">1</span>]                              <span class="co">#number of restrictions</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  logical <span class="ot">&lt;-</span> logical.last <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="at">nrow=</span>dimz[<span class="dv">1</span>], <span class="at">ncol=</span><span class="dv">1</span>)   </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>                                            <span class="co">#empty vectors with length perm.matrix</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    logical <span class="ot">&lt;-</span> logical.last                 <span class="co">#fill logical with logical.last</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    z1<span class="ot">&lt;-</span> z[i,<span class="dv">1</span>]                             <span class="co">#get first restriction value</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    z2<span class="ot">&lt;-</span> z[i,<span class="dv">2</span>]                             <span class="co">#get second restriction value</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    logical <span class="ot">&lt;-</span>                              <span class="co">#restrictions, TRUEs and FALSES saved in logical</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>      perm.matrix[,z1]<span class="sc">&lt;</span>perm.matrix[,z2]     <span class="co">#see if 1st restr. value column &lt; 2nd restr.</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    perm.matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(perm.matrix[logical],<span class="at">ncol=</span>dim[<span class="dv">2</span>]) </span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>                                            <span class="co">#save TRUE selection in perm.matrix</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    dimp <span class="ot">&lt;-</span> <span class="fu">dim</span>(perm.matrix)                <span class="co">#dimensions of new matrix</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    logical.last <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="at">nrow=</span>dimp[<span class="dv">1</span>],<span class="at">ncol=</span><span class="dv">1</span>)    </span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>                                            <span class="co">#new empty vector with length new matrix</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">sum</span>(logical)                         <span class="co">#number of TRUEs in set</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>  true <span class="ot">&lt;-</span> perm.matrix                       <span class="co">#matrix with TRUE permutations</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>  prop <span class="ot">&lt;-</span> y<span class="sc">/</span>length                          <span class="co">#TRUE n / total n = complexity</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="st">&quot;true permutations&quot;</span> <span class="ot">=</span> true, </span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;total number of permutations&quot;</span><span class="ot">=</span>length, </span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;number true&quot;</span><span class="ot">=</span>y, <span class="st">&quot;complexity (proportion)&quot;</span><span class="ot">=</span>prop)}</span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
